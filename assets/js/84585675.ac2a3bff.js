"use strict";(self.webpackChunkOERTemplate=self.webpackChunkOERTemplate||[]).push([[408],{3905:(e,t,a)=>{a.d(t,{Zo:()=>u,kt:()=>h});var n=a(7294);function o(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function r(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function i(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?r(Object(a),!0).forEach((function(t){o(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):r(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function l(e,t){if(null==e)return{};var a,n,o=function(e,t){if(null==e)return{};var a,n,o={},r=Object.keys(e);for(n=0;n<r.length;n++)a=r[n],t.indexOf(a)>=0||(o[a]=e[a]);return o}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(n=0;n<r.length;n++)a=r[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(o[a]=e[a])}return o}var s=n.createContext({}),p=function(e){var t=n.useContext(s),a=t;return e&&(a="function"==typeof e?e(t):i(i({},t),e)),a},u=function(e){var t=p(e.components);return n.createElement(s.Provider,{value:t},e.children)},m={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},c=n.forwardRef((function(e,t){var a=e.components,o=e.mdxType,r=e.originalType,s=e.parentName,u=l(e,["components","mdxType","originalType","parentName"]),c=p(a),h=o,k=c["".concat(s,".").concat(h)]||c[h]||m[h]||r;return a?n.createElement(k,i(i({ref:t},u),{},{components:a})):n.createElement(k,i({ref:t},u))}));function h(e,t){var a=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var r=a.length,i=new Array(r);i[0]=c;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l.mdxType="string"==typeof e?e:o,i[1]=l;for(var p=2;p<r;p++)i[p]=a[p];return n.createElement.apply(null,i)}return n.createElement.apply(null,a)}c.displayName="MDXCreateElement"},2997:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>s,contentTitle:()=>i,default:()=>m,frontMatter:()=>r,metadata:()=>l,toc:()=>p});var n=a(3117),o=(a(7294),a(3905));const r={id:"lab2",title:"Lab 2 - Creating and Using Virtual Machines",sidebar_position:2,description:"Lab 2"},i="Lab 2: Creating and Using Virtual Machines",l={unversionedId:"Labs/lab2",id:"Labs/lab2",title:"Lab 2 - Creating and Using Virtual Machines",description:"Lab 2",source:"@site/docs/Labs/lab2.md",sourceDirName:"Labs",slug:"/Labs/lab2",permalink:"/OSL745/Labs/lab2",draft:!1,editUrl:"https://github.com/Seneca-ICTOER/OERTemplate/tree/main/docs/Labs/lab2.md",tags:[],version:"current",sidebarPosition:2,frontMatter:{id:"lab2",title:"Lab 2 - Creating and Using Virtual Machines",sidebar_position:2,description:"Lab 2"},sidebar:"courseNotesSidebar",previous:{title:"Lab 1 - Installing Ubuntu",permalink:"/OSL745/Labs/lab1"},next:{title:"Lab 3 - Virtual Networks",permalink:"/OSL745/Labs/lab3"}},s={},p=[{value:"Lab Preparation",id:"lab-preparation",level:2},{value:"Purpose / Objectives of Lab 2",id:"purpose--objectives-of-lab-2",level:3},{value:"Minimum Required Materials",id:"minimum-required-materials",level:3},{value:"Linux Command Reference",id:"linux-command-reference",level:3},{value:"Investigation 1: Setup For Virtual Machines",id:"investigation-1-setup-for-virtual-machines",level:2},{value:"Install KVM Virtualisation Application",id:"install-kvm-virtualisation-application",level:3},{value:"Investigation 2: Install Virtual Machines (KVM)",id:"investigation-2-install-virtual-machines-kvm",level:2},{value:"Part 1: Setting up the Virtual Network",id:"part-1-setting-up-the-virtual-network",level:3},{value:"Part 2 Installing ubu1",id:"part-2-installing-ubu1",level:3},{value:"Part 3: Cloning ubu1 as ubu2",id:"part-3-cloning-ubu1-as-ubu2",level:3},{value:"Investigation 3: Managing Virtual Machines (KVM)",id:"investigation-3-managing-virtual-machines-kvm",level:2},{value:"Part 1: Backing Up Virtual Machines",id:"part-1-backing-up-virtual-machines",level:3},{value:"Part 2: Testing the backup",id:"part-2-testing-the-backup",level:3},{value:"Investigation 4: Managing VMs from the Command Line and Using Shell Scripts for VM Backup &amp; Management",id:"investigation-4-managing-vms-from-the-command-line-and-using-shell-scripts-for-vm-backup--management",level:2},{value:"Accept the Lab 2 GitHub Classroom assignment.",id:"accept-the-lab-2-github-classroom-assignment",level:3},{value:"Modifying the vs script",id:"modifying-the-vs-script",level:3},{value:"Functions",id:"functions",level:4},{value:"Changing the value of dpath",id:"changing-the-value-of-dpath",level:3},{value:"Writing the backup function",id:"writing-the-backup-function",level:3},{value:"Writing the restore function",id:"writing-the-restore-function",level:3},{value:"Cloning your GitHub repository in your Ubuntu VM",id:"cloning-your-github-repository-in-your-ubuntu-vm",level:3},{value:"Investigation 5: Troubleshooting Common Booting, and Forgotten Root Password Issues",id:"investigation-5-troubleshooting-common-booting-and-forgotten-root-password-issues",level:2},{value:"Part 1: Common Booting Issues",id:"part-1-common-booting-issues",level:3},{value:"Part 2: Booting into Single-User Mode",id:"part-2-booting-into-single-user-mode",level:3},{value:"Lab 2 Sign-Off (Show Instructor)",id:"lab-2-sign-off-show-instructor",level:2},{value:"Practice For Quizzes, Tests, Midterm &amp; Final Exam",id:"practice-for-quizzes-tests-midterm--final-exam",level:2}],u={toc:p};function m(e){let{components:t,...r}=e;return(0,o.kt)("wrapper",(0,n.Z)({},u,r,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("h1",{id:"lab-2-creating-and-using-virtual-machines"},"Lab 2: Creating and Using Virtual Machines"),(0,o.kt)("h2",{id:"lab-preparation"},"Lab Preparation"),(0,o.kt)("h3",{id:"purpose--objectives-of-lab-2"},"Purpose / Objectives of Lab 2"),(0,o.kt)("p",null,"In this lab, you will create 2 virtual machines using a virtualization program called ",(0,o.kt)("strong",{parentName:"p"},"KVM")," that will run in your ubuhost system. These VMs will be used throughout the remainder of this course to learn how to administer them (installing software, managing services, networking, etc)."),(0,o.kt)("p",null,"While you are performing this lab, it is recommended to generally note the major differences in the different installation methods, and which method you prefer to use if you were a Linux system administrator in charge of installing many Linux distributions for an organization."),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Main Objectives")),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"Installing additional Virtualization Software on your ",(0,o.kt)("strong",{parentName:"p"},"ubuhost")," machine (",(0,o.kt)("strong",{parentName:"p"},"KVM"),")")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"Create 2 separate VMs (virtual machines) using different installation methods:"),(0,o.kt)("ul",{parentName:"li"},(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"ubu1"),": Ubuntu Server 24.04 (",(0,o.kt)("strong",{parentName:"li"},"CLI only"),")"),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"ubu2"),": Ubuntu Server 24.04 Unattended Installation deployed using a ",(0,o.kt)("strong",{parentName:"li"},"autoinstall")," file (",(0,o.kt)("strong",{parentName:"li"},"CLI only"),")"))),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"Manipulate virtual machines by CLI (",(0,o.kt)("strong",{parentName:"p"},"virsh"),")")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"Properly ",(0,o.kt)("strong",{parentName:"p"},"backup VM images")," and backup ",(0,o.kt)("strong",{parentName:"p"},"VM configuration files"))),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"Create and run ",(0,o.kt)("strong",{parentName:"p"},"Bash Shell scripts")," to automatically backup our installed VM's")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("p",{parentName:"li"},"Learn to boot your Ubuntu VM into ",(0,o.kt)("strong",{parentName:"p"},"Single User mode")," for rescue purposes"))),(0,o.kt)("p",null,(0,o.kt)("img",{alt:"Lab Environment",src:a(9621).Z,width:"793",height:"468"})),(0,o.kt)("p",null,"At the end of Lab 2, your ubuhost system will contain ",(0,o.kt)("strong",{parentName:"p"},"2 virtual machines")," (",(0,o.kt)("strong",{parentName:"p"},"ubu1, ubu2 VMs")," in your ",(0,o.kt)("strong",{parentName:"p"},"KVM")," application). You will now have the option to run one virtual machine at a time, or run all machines simultaneously to learn about networking (covered in later labs)"),(0,o.kt)("h3",{id:"minimum-required-materials"},"Minimum Required Materials"),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("strong",{parentName:"li"},"Solid State Drive")),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("strong",{parentName:"li"},"USB key")," (for backups)"),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("strong",{parentName:"li"},"Lab Log Book")),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("a",{parentName:"li",href:"https://ubuntu.com/download/server/thank-you?version=24.04.1&architecture=amd64&lts=true"},(0,o.kt)("strong",{parentName:"a"},"Ubuntu Server ISO"))," (Download this before you begin)")),(0,o.kt)("h3",{id:"linux-command-reference"},"Linux Command Reference"),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Virtualization:")),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"http://linux.die.net/man/1/virt-manager"},"virt-manager")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"http://linux.die.net/man/1/virsh"},"virsh"))),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Installation Guides:")),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"https://ubuntu.com/blog/kvm-hyphervisor"},"Installing & Using KVM on Ubuntu")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"http://www.dedoimedo.com/computers/kvm-intro.html"},"Using KVM (tutorial)")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"https://libvirt.org/sources/virshcmdref/html-single/"},"virsh command reference"))),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Miscellaneous")),(0,o.kt)("table",null,(0,o.kt)("thead",{parentName:"table"},(0,o.kt)("tr",{parentName:"thead"},(0,o.kt)("th",{parentName:"tr",align:null},(0,o.kt)("a",{parentName:"th",href:"http://linuxcommand.org/lc3_man_pages/gzip1.html"},"gzip , gunzip")),(0,o.kt)("th",{parentName:"tr",align:null},(0,o.kt)("a",{parentName:"th",href:"http://man7.org/linux/man-pages/man8/ip.8.html"},"ip")),(0,o.kt)("th",{parentName:"tr",align:null},(0,o.kt)("a",{parentName:"th",href:"http://man7.org/linux/man-pages/man1/grep.1.html"},"grep")),(0,o.kt)("th",{parentName:"tr",align:null},(0,o.kt)("a",{parentName:"th",href:"http://man7.org/linux/man-pages/man1/wc.1.html"},"wc")),(0,o.kt)("th",{parentName:"tr",align:null},(0,o.kt)("a",{parentName:"th",href:"http://man7.org/linux/man-pages/man1/pwd.1.html"},"pwd")),(0,o.kt)("th",{parentName:"tr",align:null},(0,o.kt)("a",{parentName:"th",href:"http://man7.org/linux/man-pages/man1/ls.1.html"},"ls")),(0,o.kt)("th",{parentName:"tr",align:null},(0,o.kt)("a",{parentName:"th",href:"http://man7.org/linux/man-pages/man1/more.1.html"},"more")),(0,o.kt)("th",{parentName:"tr",align:null},(0,o.kt)("a",{parentName:"th",href:"http://man7.org/linux/man-pages/man1/file.1.html"},"file")),(0,o.kt)("th",{parentName:"tr",align:null},(0,o.kt)("a",{parentName:"th",href:"http://man7.org/linux/man-pages/man1/wget.1.html"},"wget")),(0,o.kt)("th",{parentName:"tr",align:null},(0,o.kt)("a",{parentName:"th",href:"http://man7.org/linux/man-pages/man1/chmod.1.html"},"chmod")),(0,o.kt)("th",{parentName:"tr",align:null},(0,o.kt)("a",{parentName:"th",href:"http://ss64.com/vi.html"},"vi"))))),(0,o.kt)("h2",{id:"investigation-1-setup-for-virtual-machines"},"Investigation 1: Setup For Virtual Machines"),(0,o.kt)("h3",{id:"install-kvm-virtualisation-application"},"Install KVM Virtualisation Application"),(0,o.kt)("p",null,"We will now install the KVM package in order to create our VMs. We will also be starting several services. We will learn more about managing firewalls in later labs."),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Perform the following steps:")),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},"Log into your ",(0,o.kt)("strong",{parentName:"li"},"ubuhost")," machine."),(0,o.kt)("li",{parentName:"ol"},"perform a software update on your debhost by issuing the following command:")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"sudo apt update && sudo apt upgrade\n")),(0,o.kt)("ol",{start:3},(0,o.kt)("li",{parentName:"ol"},"Install the kvm virtualisation packages, and a package required for the backup script later in the lab:")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"sudo apt install virt-manager progress\n")),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"About KVM")),(0,o.kt)("p",null,"There are actually several key programs installed for virtualisation using KVM:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"kvm/qemu")," - the hypervisor and other hardware emulation systems."),(0,o.kt)("li",{parentName:"ul"},"A system service named ",(0,o.kt)("strong",{parentName:"li"},"libvirtd")," that manages the VMs."),(0,o.kt)("li",{parentName:"ul"},"A graphical tool for managing virtual machines (",(0,o.kt)("strong",{parentName:"li"},"virt-manager"),") and the ",(0,o.kt)("strong",{parentName:"li"},"virsh")," command-line tool.")),(0,o.kt)("ol",{start:4},(0,o.kt)("li",{parentName:"ol"},'Now we will confirm the status of the "libvirtd" virtualisation service:')),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"sudo systemctl status libvirtd\n")),(0,o.kt)("p",null,(0,o.kt)("img",{alt:"libvirtdstatus",src:a(6562).Z,width:"1070",height:"398"})),(0,o.kt)("p",null,'In the screenshot above you can see the first "enabled" indicates that this service will start automatically when the system starts.\nThe "preset: enabled" indicates that "enabled" is the default when this service is first installed by apt.\nThe "inactive (dead)" indicates that the service is not currently running.'),(0,o.kt)("p",null,'We want the service to be "enabled" and "active":'),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Make note of the following commands for working with services:")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"# To see the status of a service (Notice sudo isn't needed with a status check!)\nsystemctl status <servicename>\n\n# To enable a service\nsudo systemctl enable <servicename>\n\n# To start a service\nsudo systemctl start <servicename>\n\n# To enable and start a service at the same time\nsudo systemctl enable --now <servicename>\n\n# To disable a service\nsudo systemctl disable <servicename>\n\n# To stop a service\nsudo systemctl stop <servicename>\n\n# To restart a service\nsudo systemctl restart <servicename>\n")),(0,o.kt)("ol",{start:5},(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},'Issue the correct commands to make sure that the "libvirtd" service is both "active" (started) and "enabled" (will start automatically at boot)'),(0,o.kt)("blockquote",{parentName:"li"},(0,o.kt)("p",{parentName:"blockquote"},(0,o.kt)("img",{alt:"caution",src:a(673).Z,width:"64",height:"64"}),"\nThe behaviour of the ",(0,o.kt)("strong",{parentName:"p"},"libvirtd")," service on Debian Linux is for the service to stop when not in use and restart when required.")),(0,o.kt)("blockquote",{parentName:"li"})),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},'In order to manage VMs your user account needs to be added to the "libvirt" group'))),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"sudo usermod -aG libvirt <username>\n")),(0,o.kt)("ol",{start:7},(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},(0,o.kt)("strong",{parentName:"p"},"Restart your ubuhost"),". If you fail to do this, you may experience virtualization network problems and issues loading Virtual Machine Manager.")),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"Once you've restarted, confirm your changes took affect by running the following as your regular user (don't use sudo):"))),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"systemctl status libvirtd\nid\ngroups\n")),(0,o.kt)("p",null,"The ",(0,o.kt)("em",{parentName:"p"},"libvirtd")," daemon should be running, and the ",(0,o.kt)("em",{parentName:"p"},"id")," and ",(0,o.kt)("em",{parentName:"p"},"groups")," commands should show that your user is part of the ",(0,o.kt)("strong",{parentName:"p"},"libvirt")," group."),(0,o.kt)("ol",{start:9},(0,o.kt)("li",{parentName:"ol"},"Start the graphical ",(0,o.kt)("inlineCode",{parentName:"li"},"virt-manager")," tool by launching your ",(0,o.kt)("strong",{parentName:"li"},"Menu")," and searching for ",(0,o.kt)("strong",{parentName:"li"},"virt-manager"),"."),(0,o.kt)("li",{parentName:"ol"},"Right click on the icon and ",(0,o.kt)("strong",{parentName:"li"},"Pin to panel")," and then run the application or by typing the command ",(0,o.kt)("inlineCode",{parentName:"li"},"virt-manager")," (without sudo!)")),(0,o.kt)("h2",{id:"investigation-2-install-virtual-machines-kvm"},"Investigation 2: Install Virtual Machines (KVM)"),(0,o.kt)("blockquote",null,(0,o.kt)("p",{parentName:"blockquote"},(0,o.kt)("img",{alt:"caution",src:a(673).Z,width:"64",height:"64"}),(0,o.kt)("strong",{parentName:"p"},"Keep the root password the same for Host and VMs")),(0,o.kt)("p",{parentName:"blockquote"},"In order to simplify running the lab checking scripts in future labs, using the same root password for ALL machines (ubuhost and virtual machines). Also use the same username and passwords for all of your machines (ubuhost and virtual machines).")),(0,o.kt)("h3",{id:"part-1-setting-up-the-virtual-network"},"Part 1: Setting up the Virtual Network"),(0,o.kt)("p",null,"Once we have installed our 2 VM's we will want to configure them to be able to communicate on the same network.\nKVM has setup a default virtual network for us to use but it is not configured to start automatically. We will also need to make sure the correct firewall and routing rules are added so that everything works.\nLets start by gathering information"),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},"Open a terminal window in ubuhost and run the following command to display the networks that ubuhost is connected to.")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"# List the networks connected and our IP address for each network interface\nip address\n")),(0,o.kt)("p",null,(0,o.kt)("img",{alt:"ipaddr",src:a(4621).Z,width:"953",height:"298"})),(0,o.kt)("ol",{start:2},(0,o.kt)("li",{parentName:"ol"},"Run the following command to list the current firewall/routing rules. (Note: Running ",(0,o.kt)("em",{parentName:"li"},"iptables")," as a regular user without sudo will make it look like the command doesn't exist. It's there.)")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"# List the iptables rules\nsudo iptables -L\n")),(0,o.kt)("p",null,(0,o.kt)("img",{alt:"ipaddr2",src:a(8430).Z,width:"1116",height:"392"}),"\n",(0,o.kt)("img",{alt:"iptables2",src:a(2007).Z,width:"892",height:"933"}),"\nYou can see that ubuhost has connected to the virtual network and iptables rules have been added to configure access to that network."),(0,o.kt)("ol",{start:3},(0,o.kt)("li",{parentName:"ol"},"Open virt-manager"),(0,o.kt)("li",{parentName:"ol"},"Select the QEMU/KVM connection and then click on Edit --\x3e Connection Details"),(0,o.kt)("li",{parentName:"ol"},"Select the Virtual Networks tab"),(0,o.kt)("li",{parentName:"ol"},'Confirm the "Autostart: On Boot". If it is not, check it and then click Apply')),(0,o.kt)("h3",{id:"part-2-installing-ubu1"},"Part 2 Installing ubu1"),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"VM Details:")),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"VM Name (and hostname)"),": ubu1"),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"Ubuntu Server 2024"),":"),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"VM Image Pathname"),": /var/lib/libvirt/images/deb1.qcow2"),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"Memory"),": 2048MB"),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"Disk space"),": 15GB"),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"CPUs"),": 2")),(0,o.kt)("blockquote",null,(0,o.kt)("p",{parentName:"blockquote"},(0,o.kt)("img",{alt:"caution",src:a(673).Z,width:"64",height:"64"}),' It would be best to download a local copy of the Debian "netinst" ISO'),(0,o.kt)("p",{parentName:"blockquote"},(0,o.kt)("a",{parentName:"p",href:"https://www.debian.org/download"},"Download Debian"))),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Perform the following steps:")),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},"Launch ",(0,o.kt)("inlineCode",{parentName:"li"},"virt-manager"),"."),(0,o.kt)("li",{parentName:"ol"},"Click the ",(0,o.kt)("strong",{parentName:"li"},"Create a new VM icon")," located near the top left-corner of the application window."),(0,o.kt)("li",{parentName:"ol"},"Select the ",(0,o.kt)("strong",{parentName:"li"},"Local install media")," option and click ",(0,o.kt)("strong",{parentName:"li"},"Forward"),"."),(0,o.kt)("li",{parentName:"ol"},"Browse to the location of your ISO image. (probably ~/Downloads) and select the iso image"),(0,o.kt)("li",{parentName:"ol"},"If the Operating System is not auto detected, uncheck the ",(0,o.kt)("strong",{parentName:"li"},'"Automatically detect from the installation media"')," and Choose ",(0,o.kt)("strong",{parentName:"li"},"Ubuntu Server 24.04"),", and click ",(0,o.kt)("strong",{parentName:"li"},"Forward"),".")),(0,o.kt)("blockquote",null,(0,o.kt)("p",{parentName:"blockquote"},(0,o.kt)("img",{alt:"vmsource",src:a(3367).Z,width:"469",height:"446"}))),(0,o.kt)("ol",{start:6},(0,o.kt)("li",{parentName:"ol"},"If a ",(0,o.kt)("strong",{parentName:"li"},'"search permissions"')," dialog box opens, Check ",(0,o.kt)("strong",{parentName:"li"},'"Don\'t ask about these directories again"')," and click ",(0,o.kt)("strong",{parentName:"li"},"yes"))),(0,o.kt)("p",null,(0,o.kt)("img",{alt:"searchperms",src:a(136).Z,width:"402",height:"266"})),(0,o.kt)("ol",{start:7},(0,o.kt)("li",{parentName:"ol"},"Set ",(0,o.kt)("strong",{parentName:"li"},"Memory"),": size to ",(0,o.kt)("strong",{parentName:"li"},"2048")," MB and ",(0,o.kt)("strong",{parentName:"li"},"CPUs")," to ",(0,o.kt)("strong",{parentName:"li"},"2"),", then click ",(0,o.kt)("strong",{parentName:"li"},"Forward"),".")),(0,o.kt)("blockquote",null,(0,o.kt)("p",{parentName:"blockquote"},(0,o.kt)("img",{alt:"memcpu",src:a(5353).Z,width:"450",height:"450"}))),(0,o.kt)("ol",{start:8},(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"Set ",(0,o.kt)("strong",{parentName:"p"},"Hard Disk")," size to ",(0,o.kt)("strong",{parentName:"p"},"15")," GB and click ",(0,o.kt)("strong",{parentName:"p"},"Forward"),".")),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"Enter the Name: ",(0,o.kt)("strong",{parentName:"p"},"ubu1"),", AND then select the option: ",(0,o.kt)("strong",{parentName:"p"},"Customize configuration before install"),", and click ",(0,o.kt)("strong",{parentName:"p"},"Finish"),".")),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"Another dialog will appear. Click ",(0,o.kt)("strong",{parentName:"p"},"CPUs"),' (or "processors") and on right-side under Configuration select ',(0,o.kt)("strong",{parentName:"p"},"Copy Host CPU Configuration"),", click ",(0,o.kt)("strong",{parentName:"p"},"Apply"),", and then click ",(0,o.kt)("strong",{parentName:"p"},"Begin Installation")," at the top left-hand side."),(0,o.kt)("blockquote",{parentName:"li"},(0,o.kt)("p",{parentName:"blockquote"},(0,o.kt)("strong",{parentName:"p"},"NOTES")),(0,o.kt)("ul",{parentName:"blockquote"},(0,o.kt)("li",{parentName:"ul"},'To have the VM "capture" the keyboard and mouse input click on the viewer window'),(0,o.kt)("li",{parentName:"ul"},"To release the keyboard and mouse from the VM use ",(0,o.kt)("strong",{parentName:"li"},"left-ctrl+left-alt")),(0,o.kt)("li",{parentName:"ul"},"To make the VM easier to display, click on ",(0,o.kt)("strong",{parentName:"li"},"View --\x3e Scale Display --\x3e Always")," > ",(0,o.kt)("img",{alt:"scale",src:a(7874).Z,width:"1044",height:"376"}))))),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"When the installer starts select Select ",(0,o.kt)("strong",{parentName:"p"},"English")," as the language.")),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"If prompted to ",(0,o.kt)("strong",{parentName:"p"},"Update to the new installer"),", do it.")),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"Set Keyboard ",(0,o.kt)("strong",{parentName:"p"},"Layout")," and ",(0,o.kt)("strong",{parentName:"p"},"Variant")," to ",(0,o.kt)("strong",{parentName:"p"},"English (US)"))),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"Check that ",(0,o.kt)("strong",{parentName:"p"},"Ubuntu Server")," is selected and select ",(0,o.kt)("strong",{parentName:"p"},"Done"),".")),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"Accept the defaults for ",(0,o.kt)("strong",{parentName:"p"},"Network Configuration")," and select ",(0,o.kt)("strong",{parentName:"p"},"Done"),".")),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"Leave proxy address blank and select ",(0,o.kt)("strong",{parentName:"p"},"Done"),".")),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"For ",(0,o.kt)("strong",{parentName:"p"},"Ubuntu archive mirror configuration")," leave the defaults and select ",(0,o.kt)("strong",{parentName:"p"},"Done"),".")),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"For ",(0,o.kt)("strong",{parentName:"p"},"Guided storage configuration")," select ",(0,o.kt)("strong",{parentName:"p"},"Use an entire disk")," and select ",(0,o.kt)("strong",{parentName:"p"},"Done"),".")),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"For ",(0,o.kt)("strong",{parentName:"p"},"Storage configuration")," read the output and select ",(0,o.kt)("strong",{parentName:"p"},"Done"),".")),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"Select ",(0,o.kt)("strong",{parentName:"p"},"Continue"),".")),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"Under ",(0,o.kt)("strong",{parentName:"p"},"Profile configuration")))),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Enter your ",(0,o.kt)("strong",{parentName:"li"},"Full name")),(0,o.kt)("li",{parentName:"ul"},"Enter a ",(0,o.kt)("strong",{parentName:"li"},"Hostname")," of ",(0,o.kt)("strong",{parentName:"li"},"ubu1")),(0,o.kt)("li",{parentName:"ul"},"Enter your ",(0,o.kt)("strong",{parentName:"li"},"Username")," (first part of your email address)"),(0,o.kt)("li",{parentName:"ul"},"Enter your ",(0,o.kt)("strong",{parentName:"li"},"password")," twice."),(0,o.kt)("li",{parentName:"ul"},"Select ",(0,o.kt)("strong",{parentName:"li"},"Done"))),(0,o.kt)("ol",{start:22},(0,o.kt)("li",{parentName:"ol"},"Skip ",(0,o.kt)("strong",{parentName:"li"},"Ubuntu Pro")," and select ",(0,o.kt)("strong",{parentName:"li"},"Continue")),(0,o.kt)("li",{parentName:"ol"},"Check the box beside ",(0,o.kt)("strong",{parentName:"li"},"Install OpenSSH server")," and select ",(0,o.kt)("strong",{parentName:"li"},"Done")),(0,o.kt)("li",{parentName:"ol"},"Under ",(0,o.kt)("strong",{parentName:"li"},"Featured server snaps")," leave the defaults and select ",(0,o.kt)("strong",{parentName:"li"},"Done")),(0,o.kt)("li",{parentName:"ol"},"When the installation is complete ",(0,o.kt)("strong",{parentName:"li"},"Reboot"),(0,o.kt)("blockquote",{parentName:"li"},(0,o.kt)("p",{parentName:"blockquote"},(0,o.kt)("img",{alt:"caution",src:a(673).Z,width:"64",height:"64"}),"\nYou may need to go into the VM details and remove the media from the ",(0,o.kt)("strong",{parentName:"p"},"CDROM")," device")))),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Post Installation Tasks")),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"Login to your ",(0,o.kt)("strong",{parentName:"p"},"ubu1")," vm.")),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"First change the ",(0,o.kt)("strong",{parentName:"p"},"tty")," display font."))),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"# Reconfigure the console font\nsudo dpkg-reconfigure console-setup\n")),(0,o.kt)("p",null,(0,o.kt)("img",{alt:"ubu1tty",src:a(722).Z,width:"467",height:"575"})),(0,o.kt)("ol",{start:3},(0,o.kt)("li",{parentName:"ol"},"Select ",(0,o.kt)("strong",{parentName:"li"},"UTF-8")),(0,o.kt)("li",{parentName:"ol"},"Select ",(0,o.kt)("strong",{parentName:"li"},"Guess optimal character set")),(0,o.kt)("li",{parentName:"ol"},"Select ",(0,o.kt)("strong",{parentName:"li"},"Terminus")),(0,o.kt)("li",{parentName:"ol"},"Select ",(0,o.kt)("strong",{parentName:"li"},"14x28"))),(0,o.kt)("p",null,"You can experiment with different settings for Font and Font size."),(0,o.kt)("ol",{start:7},(0,o.kt)("li",{parentName:"ol"},"Issue the following command to obtain the IPv4 address for your deb1 VM to record in your Lab 2 logbook:")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"ip address show\n")),(0,o.kt)("ol",{start:8},(0,o.kt)("li",{parentName:"ol"},"Issue the following command:")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"sudo less /var/log/installer/autoinstall-user-data\n")),(0,o.kt)("ol",{start:9},(0,o.kt)("li",{parentName:"ol"},"Scroll through the file. What do you think this is?"),(0,o.kt)("li",{parentName:"ol"},"This file was generated when you installed ",(0,o.kt)("strong",{parentName:"li"},"ubu1"),".")),(0,o.kt)("h3",{id:"part-3-cloning-ubu1-as-ubu2"},"Part 3: Cloning ubu1 as ubu2"),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"VM Details:")),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"VM Name (and hostname)"),": ubu2"),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"VM Image Pathname"),": /var/lib/libvirt/images/ubu2.qcow2"),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"Memory"),": 2048MB"),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"Disk space"),": 15GB"),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"CPUs"),": 1")),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Perform the following steps:")),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},"Launch ",(0,o.kt)("strong",{parentName:"li"},"virt-manager"),"."),(0,o.kt)("li",{parentName:"ol"},"Right click on ",(0,o.kt)("strong",{parentName:"li"},"ubu1")," and select ",(0,o.kt)("strong",{parentName:"li"},"clone"),"."),(0,o.kt)("li",{parentName:"ol"},"Set the ",(0,o.kt)("strong",{parentName:"li"},"Name")," to ",(0,o.kt)("strong",{parentName:"li"},"ubu2"),"."),(0,o.kt)("li",{parentName:"ol"},"Click ",(0,o.kt)("strong",{parentName:"li"},"Clone"),".")),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Post Installation Tasks")),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"Repeat the steps from your ",(0,o.kt)("strong",{parentName:"p"},"ubu1")," install to change your ",(0,o.kt)("strong",{parentName:"p"},"tty")," font.")),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"Issue the following command to obtain the IPv4 address for your ",(0,o.kt)("strong",{parentName:"p"},"ubu2")," VM to record in your Lab 2 logbook:"))),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"ip address show\n")),(0,o.kt)("ol",{start:3},(0,o.kt)("li",{parentName:"ol"},"Change the hostname to ",(0,o.kt)("strong",{parentName:"li"},"ubu2")," immediately:")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"sudo hostnamectl set-hostname --static ubu2\n")),(0,o.kt)("ol",{start:4},(0,o.kt)("li",{parentName:"ol"},"Issue the hostnamectl command to confirm the changes have been applied.")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"sudo hostnamectl\n")),(0,o.kt)("ol",{start:5},(0,o.kt)("li",{parentName:"ol"},"Logout and log back in to apply the changes to your command prompt.")),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Answer INVESTIGATION 2 observations / questions in your lab log book.")),(0,o.kt)("h2",{id:"investigation-3-managing-virtual-machines-kvm"},"Investigation 3: Managing Virtual Machines (KVM)"),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Root Privileges")),(0,o.kt)("p",null,"As part of this investigation you will learn how to switch over to the root account in order to run several privileged commands in sequence. It can be tempting to just use this technique all the time, and never have to worry about sudo, but do ",(0,o.kt)("strong",{parentName:"p"},"not")," do so. It undermines the security of your system. Use it only when you need it."),(0,o.kt)("h3",{id:"part-1-backing-up-virtual-machines"},"Part 1: Backing Up Virtual Machines"),(0,o.kt)("blockquote",null,(0,o.kt)("p",{parentName:"blockquote"},(0,o.kt)("img",{alt:"caution",src:a(673).Z,width:"64",height:"64"}),'\nTaking the time to backup the image of the Virtual Machines filesystem allows the user to return to a "',(0,o.kt)("strong",{parentName:"p"},"restoration point"),'" using the ',(0,o.kt)("strong",{parentName:"p"},"gunzip")," command."),(0,o.kt)("p",{parentName:"blockquote"},"This allows us to recover in case something bad occurs during a Lab!"),(0,o.kt)("p",{parentName:"blockquote"},"Failure to take the time to make and confirm backups can result in loss of lab work for the student!"),(0,o.kt)("p",{parentName:"blockquote"},"There are three general steps to back up your Virtual Machines:"),(0,o.kt)("ul",{parentName:"blockquote"},(0,o.kt)("li",{parentName:"ul"},"Shutdown the VM"),(0,o.kt)("li",{parentName:"ul"},"Create a compressed copy of your ",(0,o.kt)("strong",{parentName:"li"},"Disk Images")," using the ",(0,o.kt)("strong",{parentName:"li"},"gzip")," command."),(0,o.kt)("li",{parentName:"ul"},"Backup the VM xml configuration using the ",(0,o.kt)("strong",{parentName:"li"},"virsh")," shell command."))),(0,o.kt)("p",null,"The ",(0,o.kt)("inlineCode",{parentName:"p"},"virsh")," command is a command line tool/shell for managing VM's. We use it to connect to the hypervisor and then interact with our VM's"),(0,o.kt)("p",null,"The following example ",(0,o.kt)("inlineCode",{parentName:"p"},"virsh")," commands will be useful"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"# List all running (active) VM's\nvirsh list\n\n# List all inactive VM's\nvirsh list --inactive\n\n# List all VM's (active or not)\nvirsh list --all\n\n# Start a VM\nvirsh start <vmname>\n\n# Shutdown a VM\nvirsh shutdown <vmname>\n\n# Force off a VM (if shutdown fails)\nvirsh destroy <vmname>\n\n# Display the xml data that defines the VM configuration\nvirsh dumpxml <vmname>\n")),(0,o.kt)("p",null,"To view the VM in a window without launching ",(0,o.kt)("inlineCode",{parentName:"p"},"virt-manager")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"# Open VM in viewer window\nvirt-viewer <vmname> &\n")),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"On ubuhost")),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},"Shut down your ",(0,o.kt)("strong",{parentName:"li"},"ubu1"),", and ",(0,o.kt)("strong",{parentName:"li"},"ubu2")," VMs. (Use the ",(0,o.kt)("inlineCode",{parentName:"li"},"virsh")," command)",(0,o.kt)("blockquote",{parentName:"li"},(0,o.kt)("p",{parentName:"blockquote"},(0,o.kt)("img",{alt:"caution",src:a(673).Z,width:"64",height:"64"}),"\nYou can shutdown the VM's by issuing the following command to shutdown: ",(0,o.kt)("inlineCode",{parentName:"p"},"sudo poweroff"),", or you can use the ",(0,o.kt)("inlineCode",{parentName:"p"},"virsh")," command.\nPlease be patient, the VMs will shut down!"))),(0,o.kt)("li",{parentName:"ol"},"Create a directory for your backups.")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"mkdir ~/backups\n")),(0,o.kt)("ol",{start:3},(0,o.kt)("li",{parentName:"ol"},"Enter the command")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"virsh dumpxml ubu1\n")),(0,o.kt)("p",null,"This command will output the xml data that is used to define (create) this VM\nIf we save this output we could use that xml data to recreate the VM"),(0,o.kt)("ol",{start:5},(0,o.kt)("li",{parentName:"ol"},"Enter the command")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"virsh dumpxml ubu1 > ~/backups/ubu1.xml\n")),(0,o.kt)("p",null,"this will save a copy of the output."),(0,o.kt)("ol",{start:6},(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"Repeat the steps to save the xml data for ",(0,o.kt)("inlineCode",{parentName:"p"},"ubu2")," to the file ",(0,o.kt)("inlineCode",{parentName:"p"},"~/backups/ubu2.xml")),(0,o.kt)("p",{parentName:"li"},"Backing up the xml data only has to be done when the VM is created, or if the configuration is modified.")),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"We will need to use elevated privileges to backup our disk image files from the default location of ",(0,o.kt)("inlineCode",{parentName:"p"},"/var/lib/libvirt/images/"))),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"Use the command ",(0,o.kt)("inlineCode",{parentName:"p"},"sudo -i")," and enter your password if prompted."))),(0,o.kt)("blockquote",null,(0,o.kt)("p",{parentName:"blockquote"},(0,o.kt)("inlineCode",{parentName:"p"},"sudo -i")," will start a new shell as the root user, you can run a number of commands and then type ",(0,o.kt)("inlineCode",{parentName:"p"},"exit")," to return to your previous shell.")),(0,o.kt)("ol",{start:9},(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"Change to the images directory: ",(0,o.kt)("inlineCode",{parentName:"p"},"cd /var/lib/libvirt/images/"),". Note that you did not need to use sudo, as you are already using elevated permissions.")),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"Type ",(0,o.kt)("inlineCode",{parentName:"p"},"ls -lh")," to see the contents")),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"To make a compressed copy of your ",(0,o.kt)("strong",{parentName:"p"},"ubu1.qcow2"),", and ",(0,o.kt)("strong",{parentName:"p"},"ubu2.qcow2")," files we will use the ",(0,o.kt)("inlineCode",{parentName:"p"},"gzip")," command."),(0,o.kt)("pre",{parentName:"li"},(0,o.kt)("code",{parentName:"pre"},"The `gzip` command will compress the file in place and rename the file with a `.gz` extension.\nHowever, this will make the file unusable and doesn't create a copy. We will use STDIN and STDOUT redirection to overcome this.\n")),(0,o.kt)("blockquote",{parentName:"li"},(0,o.kt)("p",{parentName:"blockquote"},"The following commands will create a compressed backup of ubu1 and ubu2's virtual disks. These commands will take time (approximately 3-5 minutes per VM) to complete. Be patient."))),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"Issue the commands:"))),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"gzip < ubu1.qcow2 > ~YourRegularUsername/backups/ubu1.qcow2.gz\n\ngzip < ubu2.qcow2 > ~YourRegularUsername/backups/ubu2.qcow2.gz & progress --monitor --pid=$!\n")),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"NOTE"),': Make certain to use the redirection signs "<" and "',">",'" properly in the command!'),(0,o.kt)("blockquote",null,(0,o.kt)("p",{parentName:"blockquote"},(0,o.kt)("img",{alt:"caution",src:a(673).Z,width:"64",height:"64"}),(0,o.kt)("strong",{parentName:"p"},"Please be patient")),(0,o.kt)("p",{parentName:"blockquote"},"It may look like the command prompt is stuck but it could take a while for gzip to compress an entire operating system."),(0,o.kt)("p",{parentName:"blockquote"},(0,o.kt)("strong",{parentName:"p"},"NOTE"),": Do ",(0,o.kt)("strong",{parentName:"p"},"NOT")," press ",(0,o.kt)("inlineCode",{parentName:"p"},"<ctrl>c")," to cancel this process. If you do, your archive will become incomplete and your recovery will be corrupt."),(0,o.kt)("p",{parentName:"blockquote"},"Note the difference between the backup for ",(0,o.kt)("strong",{parentName:"p"},"ubu1"),", and ",(0,o.kt)("strong",{parentName:"p"},"ubu2")," which included the additional progress command. This is a useful utility.")),(0,o.kt)("ol",{start:13},(0,o.kt)("li",{parentName:"ol"},"Compare the size of the compressed and original files (hint: use ",(0,o.kt)("inlineCode",{parentName:"li"},"ls -lh"),"). If file is very large (like 15GB), you didn't compress it and you need to remove that file and perform the previous step until you get it right!"),(0,o.kt)("li",{parentName:"ol"},"Once you are ",(0,o.kt)("strong",{parentName:"li"},"sure you have both VM disk images backed up"),", use the ",(0,o.kt)("inlineCode",{parentName:"li"},"exit")," command to revert back to your normal user.")),(0,o.kt)("p",null,(0,o.kt)("img",{alt:"vmbackup",src:a(9724).Z,width:"601",height:"316"})),(0,o.kt)("h3",{id:"part-2-testing-the-backup"},"Part 2: Testing the backup"),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"Start the ",(0,o.kt)("strong",{parentName:"p"},"ubu2")," VM and login."),(0,o.kt)("blockquote",{parentName:"li"},(0,o.kt)("p",{parentName:"blockquote"},(0,o.kt)("img",{alt:"caution",src:a(673).Z,width:"64",height:"64"})," ",(0,o.kt)("strong",{parentName:"p"},"THIS WILL DESTROY YOUR SYSTEM")),(0,o.kt)("p",{parentName:"blockquote"},(0,o.kt)("strong",{parentName:"p"},"Make certain that you are in your ",(0,o.kt)("inlineCode",{parentName:"strong"},"ubu2")," VM and not in ",(0,o.kt)("inlineCode",{parentName:"strong"},"ubuhost"),"!")))),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"Type this command inside the ubu2 virtual machine: ",(0,o.kt)("inlineCode",{parentName:"p"},"sudo rm -rf /*")," (ignore error messages).")),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"Type the command ",(0,o.kt)("inlineCode",{parentName:"p"},"sudo poweroff"),", try other commands.")),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"Force the VM to poweroff and restart")),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"When the machine restarts it will not boot since all system files have been removed!")),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"Use the ",(0,o.kt)("strong",{parentName:"p"},"Force Off")," option to turn ubu2 back off.")),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"Run ",(0,o.kt)("inlineCode",{parentName:"p"},"virt-manager")," right click on the ",(0,o.kt)("inlineCode",{parentName:"p"},"ubu2")," VM and select ",(0,o.kt)("strong",{parentName:"p"},"Delete")," make sure that ",(0,o.kt)("strong",{parentName:"p"},"Delete associated storage file")," is selected and ",(0,o.kt)("strong",{parentName:"p"},"Delete")),(0,o.kt)("p",{parentName:"li"},(0,o.kt)("inlineCode",{parentName:"p"},"ubu2")," is now completely gone. Time to test the backup!")),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"To restore the VM configuration:"))),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"# List all VM's\nvirsh list --all\n\n# Define a VM from xml data\nvirsh define ~/backups/ubu2.xml\n\n# List all VM's\nvirsh list --all\n")),(0,o.kt)("ol",{start:8},(0,o.kt)("li",{parentName:"ol"},"To restore the ",(0,o.kt)("inlineCode",{parentName:"li"},"ubu2")," disk image file:")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"# Start a sudo shell\nsudo -i\n\n# Change to images directory\ncd /var/lib/libvirt/images\n\n# Restore file\ngunzip < ~YourRegularUserName/backups/ubu2.qcow2.gz > ubu2.qcow2\n\n# Return to previous shell\nexit\n\n")),(0,o.kt)("ol",{start:9},(0,o.kt)("li",{parentName:"ol"},"Start the ",(0,o.kt)("inlineCode",{parentName:"li"},"ubu2")," VM and login to make sure it was successfully restored")),(0,o.kt)("blockquote",null,(0,o.kt)("p",{parentName:"blockquote"},(0,o.kt)("img",{alt:"caution",src:a(673).Z,width:"64",height:"64"}),(0,o.kt)("strong",{parentName:"p"},"Shutting Down the Host while Virtual Machines are Running")),(0,o.kt)("p",{parentName:"blockquote"},"If you shut down your host system while virtual machines are running, they will be suspended, and will resume the next time you boot your host system. Note that it is better to shut down the VMs prior to shutting down the host")),(0,o.kt)("ol",{start:10},(0,o.kt)("li",{parentName:"ol"},"For the remainder of these labs, it is assumed that you will backup ",(0,o.kt)("strong",{parentName:"li"},"both")," the images and XML configuration files for ",(0,o.kt)("strong",{parentName:"li"},"all"),' Virtual machines, when asked to backup your virtual machines. It is also highly recommended to backup these files to an external storage device (eg. USB key) in case the host machine gets "wiped" and you need to rebuild your HOST machine and then restore your Virtual Machines.'),(0,o.kt)("li",{parentName:"ol"},"Answer this question in your log book:")),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"In order to fully back up a virtual machine, what information should be saved in addition to the virtual machine image?")),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Answer INVESTIGATION 3 observations / questions in your lab log book.")),(0,o.kt)("h2",{id:"investigation-4-managing-vms-from-the-command-line-and-using-shell-scripts-for-vm-backup--management"},"Investigation 4: Managing VMs from the Command Line and Using Shell Scripts for VM Backup & Management"),(0,o.kt)("p",null,"You will continue our use of Bash Shell scripting by first creating a Bash Shell script that will allow the Linux sysadmin to select their created VMs for backup. Afterwards you will download, view and run a couple of Bash Shell scripts that use the virsh command to start and stop your virtual machines."),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Perform the following steps:")),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},"Start the ",(0,o.kt)("strong",{parentName:"li"},"ubu1")," virtual machine, and stop the ",(0,o.kt)("strong",{parentName:"li"},"ubu2")," virtual machine."),(0,o.kt)("li",{parentName:"ol"},"Switch to the ",(0,o.kt)("strong",{parentName:"li"},"ubuhost")," machine, and open a shell terminal."),(0,o.kt)("li",{parentName:"ol"},"Enter these admin commands into your ",(0,o.kt)("strong",{parentName:"li"},"ubuhost")," machine and note the result:")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"virsh list\n")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"virsh list --all\n")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"virsh list --inactive\n")),(0,o.kt)("ol",{start:4},(0,o.kt)("li",{parentName:"ol"},"Now, shut-down your ubu1 VM normally, and close the ubu1 VM window."),(0,o.kt)("li",{parentName:"ol"},"Switch to your terminal and issue the command:")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"virsh start ubu1\n")),(0,o.kt)("ol",{start:6},(0,o.kt)("li",{parentName:"ol"},"Using the appropriate command check to see if your ubu1 VM is now running."),(0,o.kt)("li",{parentName:"ol"},"There are other commands that can be used (such as ",(0,o.kt)("strong",{parentName:"li"},"suspend"),", or ",(0,o.kt)("strong",{parentName:"li"},"shutdown"),'). The "shutdown" command may not always work since it relies on the guest handling a particular ACPI event. Why do you think it is useful to have commands to manipulate VMs?')),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Virtual Machine Does not Shutdown from Command")),(0,o.kt)("p",null,"If the Virtual machine fails to shutdown from the ",(0,o.kt)("inlineCode",{parentName:"p"},"virsh shutdown")," command, then you can go to the ",(0,o.kt)("strong",{parentName:"p"},"Virtual Machine manager")," and ",(0,o.kt)("strong",{parentName:"p"},"halt")," or ",(0,o.kt)("strong",{parentName:"p"},"shutdown")," within the VM itself, then you can click the ",(0,o.kt)("strong",{parentName:"p"},"PowerOff")," button in the VM window. You'll want to avoid a forced shutdown since those are equivalent to yanking the power cord out of the wall on a physical machine!"),(0,o.kt)("h3",{id:"accept-the-lab-2-github-classroom-assignment"},"Accept the Lab 2 GitHub Classroom assignment."),(0,o.kt)("p",null,"Use the following ",(0,o.kt)("a",{parentName:"p",href:"https://classroom.github.com/a/igcEQwgi"},"link")," to set up your lab 2 repository. You will be using this for this investigation."),(0,o.kt)("p",null,"Next, follow the sections for setup on a Shared Computer by Accessing GitHub Codespaces or on your Personal Computer. While you can install Visual Studio Code (VSCode) locally, I recommend using Codespaces for this course."),(0,o.kt)("p",null,"Once you have set up your Lab 2 repository by following the link above (go back and do that if you missed it), you can access GitHub Codespaces from any browser on any device (PC, tablet, smart phone). Codespaces gives you access to Visual Studio Code, with direct access to your repository (without having to clone) from anywhere. It's perfect for a portable development environment. Login to GitHub (if you haven't already) and proceed."),(0,o.kt)("p",null,"You may have noticed in the link above you can click ",(0,o.kt)("strong",{parentName:"p"},"Open in GitHub Codespaces"),". Feel free to do so now. If you have already clicked past that window the next few steps will show you how to access it again (which is useful for future access attempts anyway). Click on ",(0,o.kt)("strong",{parentName:"p"},"Code")," and create a new codespace. Once you have created it, you can access it by clicking on the named link."),(0,o.kt)("p",null,(0,o.kt)("img",{alt:"Accessing GitHub Codespaces",src:a(7461).Z,width:"942",height:"665"})),(0,o.kt)("h3",{id:"modifying-the-vs-script"},"Modifying the vs script"),(0,o.kt)("p",null,"Once your Codespace has created, open the provided template called ",(0,o.kt)("strong",{parentName:"p"},"vs"),", and update the comment block to include ",(0,o.kt)("strong",{parentName:"p"},"your name")," and ",(0,o.kt)("strong",{parentName:"p"},"today's date"),"."),(0,o.kt)("p",null,"Examine the entire ",(0,o.kt)("strong",{parentName:"p"},"vs")," script. Note that the only sections left to complete are the function declarations. You should be able to understand the rest of the script, as the concepts were covered in OSL645."),(0,o.kt)("p",null,"This script will:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Accept the following options from the command line:",(0,o.kt)("ul",{parentName:"li"},(0,o.kt)("li",{parentName:"ul"},"b: to backup virtual machines"),(0,o.kt)("li",{parentName:"ul"},"r: to restore virtual machines"),(0,o.kt)("li",{parentName:"ul"},"o vmname: when called with ",(0,o.kt)("strong",{parentName:"li"},"b")," or ",(0,o.kt)("strong",{parentName:"li"},"r")," will perform that action on just the virtual machine (vmname) provided"),(0,o.kt)("li",{parentName:"ul"},"f: used with ",(0,o.kt)("strong",{parentName:"li"},"r")," to indicate a fresh install of the host. This will install the virtualization software and updates.")))),(0,o.kt)("h4",{id:"functions"},"Functions"),(0,o.kt)("p",null,"Bash functions provide several benefits when writing and using shell scripts:"),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},(0,o.kt)("strong",{parentName:"p"},"Code Reusability"),": Functions allow you to recall code that you need to use multiple times. This reduces redundancy and makes your scripts more maintainable.")),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},(0,o.kt)("strong",{parentName:"p"},"Modularity"),": By breaking your script into functions, you can create modular code. Each function can perform a specific task, making your script easier to understand and debug.")),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},(0,o.kt)("strong",{parentName:"p"},"Readability"),": Functions can make your scripts more readable by giving meaningful names to blocks of code. This helps others (and yourself) understand what each part of the script is doing.")),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},(0,o.kt)("strong",{parentName:"p"},"Maintainability"),": When you need to update or fix a part of your script, you can do so in one place if that code is within a function. This makes maintenance easier and reduces the risk of introducing errors.")),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},(0,o.kt)("strong",{parentName:"p"},"Parameterization"),": Functions can accept parameters, allowing you to write more flexible and general-purpose code. This makes your scripts more adaptable to different situations."))),(0,o.kt)("p",null,"In this example, the ",(0,o.kt)("inlineCode",{parentName:"p"},"greet")," function takes one parameter and prints the message ",(0,o.kt)("strong",{parentName:"p"},"Hello World!"),". This function can be reused with different parameters throughout the script."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},'#!/bin/bash\n\n# Define a function\ngreet() {\n  echo "Hello, $1!"\n}\n\n# Call the function with a parameter\ngreet "World"\n')),(0,o.kt)("h3",{id:"changing-the-value-of-dpath"},"Changing the value of dpath"),(0,o.kt)("p",null,"Change the value of the dpath variable to ",(0,o.kt)("strong",{parentName:"p"},"YOUR")," username:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},'dpath="/home/username/backups"\n')),(0,o.kt)("h3",{id:"writing-the-backup-function"},"Writing the backup function"),(0,o.kt)("p",null,"Use the following code to write the backup function:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},'# A function to back up the virtual machines\nfunction backup() {\n\n    # Change directory to where the virtual machines are stored as files\n    cd $spath\n\n    # Use virsh dumpxml to create a backup of the xml file for the virtual machine\n    virsh dumpxml $vm >$dpath/$vm.xml\n\n    # tell the user the back up is in progress\n    echo "Creating backup of $vm in $dpath"\n\n    # Use touch to create the backup destination file if it doesn\'t exist, update the time and date stamp if it does\n    touch $dpath/$vm.backup.gz\n\n    # gzip images and store them in back up directory, run in the background\n    gzip < $spath/$vm.qcow2 > $dpath/$vm.qcow2.gz & progress --monitor --pid=$!\n\n    # Append the name of the virtual machine to the log message variable (logMsg)\n    logMsg="$logMsg $vm,"\n}\n')),(0,o.kt)("h3",{id:"writing-the-restore-function"},"Writing the restore function"),(0,o.kt)("p",null,"Use the following code to write the restore function:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},'# A function to restore the virtual machines\nfunction restore() {\n\n    # Change directory to where the virtual machine backups are stored\n    cd $spath\n\n    # Tell the user the restoration is in progress\n    echo "Restoring $vm"\n\n    # Use the gunzip command to unzip the backup file and restore it to /var/lib/libvirt/images\n    gunzip < $dpath/$vm.qcow2.gz > $spath/$vm.qcow2 & progress --monitor --pid=$!\n\n    # Append the name of the virtual machine to the log message variable (logMsg)\n    logMsg="$logMsg $vm,"\n\n    # Copy the xml file to the /var/lib/libvirt/images directory\n    cp $spath/$vm.xml $dpath/$vm.xml\n\n    # Use virsh define to define the virtual machine\n    virsh define $vm.xml\n}\n')),(0,o.kt)("p",null,"In Codespaces, give your vs script execute permission."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"chmod u+x vs\n")),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Stage your changes and commit them to GitHub.")),(0,o.kt)("h3",{id:"cloning-your-github-repository-in-your-ubuntu-vm"},"Cloning your GitHub repository in your Ubuntu VM"),(0,o.kt)("p",null,"Issue the following command to clone your GitHub repository into your home directory."),(0,o.kt)("blockquote",null,(0,o.kt)("p",{parentName:"blockquote"},(0,o.kt)("strong",{parentName:"p"},"Important:")," Be sure to replace ",(0,o.kt)("inlineCode",{parentName:"p"},"username")," in the following command with YOUR GitHub username.")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"git clone git@github.com:OSL745/lab-2-username\n")),(0,o.kt)("p",null,"Change to your lab directory, and run your script to create a fresh backup of all your VMs. If you get any errors, double check your script (in codespaces) against the lab instructions. The ",(0,o.kt)("strong",{parentName:"p"},"only")," things you should have modified are the ",(0,o.kt)("strong",{parentName:"p"},"backup")," and ",(0,o.kt)("strong",{parentName:"p"},"restore")," functions."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"cd lab-2-username\nsudo ./vs -b\n")),(0,o.kt)("p",null,"Now that you have a working backup script, you are expected to make a fresh backup of your VMs every lab. You will also want to copy these to an exteral USB flash drive. In the event your main drive fails, you will have the backup of your VMs and at worst only have to reinstall your host (Lab 1)."),(0,o.kt)("ol",{start:17},(0,o.kt)("li",{parentName:"ol"},'You have completed lab2. Proceed to Completing The Lab, and follow the instructions for "lab sign-off".')),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Answer INVESTIGATION 4 observations / questions in your lab log book.")),(0,o.kt)("h2",{id:"investigation-5-troubleshooting-common-booting-and-forgotten-root-password-issues"},"Investigation 5: Troubleshooting Common Booting, and Forgotten Root Password Issues"),(0,o.kt)("h3",{id:"part-1-common-booting-issues"},"Part 1: Common Booting Issues"),(0,o.kt)("p",null,'There are a few "classic problems" that students can encounter with their virtual machines and their host machine after performing lab2. Although all OPS245 students may not encounter these problems, it is good to be aware of what a potential problem may look like, and know how to solve that problem.'),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"A few common problems are:")),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"I Can't boot into Graphical Mode on my ",(0,o.kt)("strong",{parentName:"li"},"debhost")," machine"),(0,o.kt)("li",{parentName:"ul"},"I Forgot My ",(0,o.kt)("strong",{parentName:"li"},"Regular User")," Password"),(0,o.kt)("li",{parentName:"ul"},"I Forgot My ",(0,o.kt)("strong",{parentName:"li"},"root")," Password"),(0,o.kt)("li",{parentName:"ul"},"I Can't Start My Virtual Machine")),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Troubleshooting skills take time to develop. Your approach should be methodical. Consider the following elements:")),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"Gathering Information")),(0,o.kt)("li",{parentName:"ul"},'Asking questions like "What was changed recently"'),(0,o.kt)("li",{parentName:"ul"},"Examining Log files"),(0,o.kt)("li",{parentName:"ul"},"Reading documentation and searching the Internet"),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"Eliminating")," what the problem ",(0,o.kt)("strong",{parentName:"li"},"IS NOT")),(0,o.kt)("li",{parentName:"ul"},"Testing possible solutions one at a time"),(0,o.kt)("li",{parentName:"ul"},"Documenting the problem")),(0,o.kt)("h3",{id:"part-2-booting-into-single-user-mode"},"Part 2: Booting into Single-User Mode"),(0,o.kt)("p",null,"If you cannot login graphically to your machine (first two common problems), there is an option to boot your system into ",(0,o.kt)("strong",{parentName:"p"},"single-user")," mode. (Sometimes called ",(0,o.kt)("strong",{parentName:"p"},"rescue mode"),")"),(0,o.kt)("p",null,'This "mode" puts the OS into a state that does not provide networking, graphics, or the ability to login in as other regular users.\nYou can only login to a TTY (text interface) as the user ',(0,o.kt)("strong",{parentName:"p"},"root"),"."),(0,o.kt)("blockquote",null,(0,o.kt)("p",{parentName:"blockquote"},(0,o.kt)("img",{alt:"caution",src:a(673).Z,width:"64",height:"64"})," This method will only work if a GRUB (",(0,o.kt)("strong",{parentName:"p"},"Gr"),"and ",(0,o.kt)("strong",{parentName:"p"},"U"),"nified ",(0,o.kt)("strong",{parentName:"p"},"B"),"oot-loader) password has not been set, or that you haven't forgotten the GRUB password.")),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Perform the following steps:")),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},"Boot up your ",(0,o.kt)("strong",{parentName:"li"},"debhost"),"."),(0,o.kt)("li",{parentName:"ol"},"Login as as a regular user."),(0,o.kt)("li",{parentName:"ol"},"Boot-up your ",(0,o.kt)("strong",{parentName:"li"},"deb1")," VM. ",(0,o.kt)("strong",{parentName:"li"},"When the Grub Boot menu appears"),", press the letter ",(0,o.kt)("inlineCode",{parentName:"li"},"e"),' (for "edit").\n',(0,o.kt)("img",{alt:"deb1grub",src:a(957).Z,width:"742",height:"550"})),(0,o.kt)("li",{parentName:"ol"},"Using your arrow keys, scroll down to the line that starts with ",(0,o.kt)("inlineCode",{parentName:"li"},"linux")," add the word ",(0,o.kt)("inlineCode",{parentName:"li"},"single")," as an argument after ",(0,o.kt)("strong",{parentName:"li"},"quiet")," (see diagram below for reference) and then press ",(0,o.kt)("inlineCode",{parentName:"li"},"ctrl-x")," to boot.")),(0,o.kt)("p",null,(0,o.kt)("img",{alt:"deb1grubsingle",src:a(9701).Z,width:"1139",height:"815"})),(0,o.kt)("ol",{start:5},(0,o.kt)("li",{parentName:"ol"},"The system should boot into a text-based interface. Enter your ",(0,o.kt)("strong",{parentName:"li"},"root")," password.\n",(0,o.kt)("img",{alt:"single",src:a(4055).Z,width:"792",height:"196"}),"\nOne thing that can cause the graphical interface to not function is lack of disk space. All graphical interfaces need to write to temporary files on disk.\nIf your disk is full it will fail."),(0,o.kt)("li",{parentName:"ol"},"To look at storage utilization. Issue the command: ",(0,o.kt)("inlineCode",{parentName:"li"},"df -h"),(0,o.kt)("img",{alt:"df",src:a(3236).Z,width:"714",height:"250"}),(0,o.kt)("blockquote",{parentName:"li"},(0,o.kt)("p",{parentName:"blockquote"},"Temporary files are written to the ",(0,o.kt)("inlineCode",{parentName:"p"},"/tmp")," directory, so in the image above that would be on the storage device mounted on ",(0,o.kt)("inlineCode",{parentName:"p"},"/"),"\nIf you have problems with disk space in this course it is likely because you have not been backing up your VM's correctly.\n",(0,o.kt)("strong",{parentName:"p"},"Do NOT remove the image in ",(0,o.kt)("em",{parentName:"strong"},"/var/lib/libvirt/images")," directory"),"!")))),(0,o.kt)("p",null,"If you are unable to login to the graphical environment because you have forgotten your password you can use the ",(0,o.kt)("inlineCode",{parentName:"p"},"passwd")," command as root to reset it."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"# Change a users password\npasswd <username>\n")),(0,o.kt)("ol",{start:7},(0,o.kt)("li",{parentName:"ol"},"To restart in graphical mode, simply enter the command ",(0,o.kt)("inlineCode",{parentName:"li"},"reboot"),".")),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Answer INVESTIGATION 4 observations / questions in your lab log book.")),(0,o.kt)("h2",{id:"lab-2-sign-off-show-instructor"},"Lab 2 Sign-Off (Show Instructor)"),(0,o.kt)("p",null,"Follow the submission instructions that your Professor provides."),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Backup ALL of your VMs!")),(0,o.kt)("p",null,"If you have successfully completed this lab, make a new backup of all of your virtual machines onto your USB Key."),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Perform the Following Steps:")),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},"Use the ",(0,o.kt)("strong",{parentName:"li"},"virsh start")," command to launch all the VMs (",(0,o.kt)("strong",{parentName:"li"},"deb1"),", ",(0,o.kt)("strong",{parentName:"li"},"deb2"),", and ",(0,o.kt)("strong",{parentName:"li"},"deb3"),")."),(0,o.kt)("li",{parentName:"ol"},"Inside each virtual machine, run ",(0,o.kt)("inlineCode",{parentName:"li"},"ip a")," on the command line. Open a Terminal window in deb1 to do so. You'll need the IP address of each machine for the next steps."),(0,o.kt)("li",{parentName:"ol"},"Switch to your ",(0,o.kt)("strong",{parentName:"li"},"debhost"),", open a terminal, and change directory to ",(0,o.kt)("strong",{parentName:"li"},"~/bin"),"."),(0,o.kt)("li",{parentName:"ol"},"Issue the command:")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"wget https://raw.githubusercontent.com/OPS245/debian-labs/main/lab2-check.bash\n")),(0,o.kt)("ol",{start:5},(0,o.kt)("li",{parentName:"ol"},"Give the ",(0,o.kt)("strong",{parentName:"li"},"lab2-check.bash")," execute permissions for the file owner."),(0,o.kt)("li",{parentName:"ol"},'Run the shell script and if there are any warnings, make fixes and re-run shell script until you receive the "Congratulations" message.'),(0,o.kt)("li",{parentName:"ol"},"Follow the submission instructions of your Professor:")),(0,o.kt)("h2",{id:"practice-for-quizzes-tests-midterm--final-exam"},"Practice For Quizzes, Tests, Midterm & Final Exam"),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},"How do you start and stop virtual machines?"),(0,o.kt)("li",{parentName:"ol"},"What is the purpose of the virsh command?"),(0,o.kt)("li",{parentName:"ol"},"List the steps to correctly backup your VM's xml data"),(0,o.kt)("li",{parentName:"ol"},"List the steps to correctly backup your VM's disk images"),(0,o.kt)("li",{parentName:"ol"},"List the steps to correctly restore your VMs"),(0,o.kt)("li",{parentName:"ol"},"How can you prompt the user for data and store into a variable?"),(0,o.kt)("li",{parentName:"ol"},"Show a few examples of bash loops that can be used to error-check user input."),(0,o.kt)("li",{parentName:"ol"},"What does the command ",(0,o.kt)("strong",{parentName:"li"},"apt update")," do and why is it important?"),(0,o.kt)("li",{parentName:"ol"},"What does the command ",(0,o.kt)("strong",{parentName:"li"},"apt upgrade")," do and why is it important?"),(0,o.kt)("li",{parentName:"ol"},"What is the purpose of booting into single-user mode?"),(0,o.kt)("li",{parentName:"ol"},"List the steps in order to boot into single-user mode.")))}m.isMDXComponent=!0},673:(e,t,a)=>{a.d(t,{Z:()=>n});const n="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAACXBIWXMAAAsTAAALEwEAmpwYAAAGuUlEQVR4nO1aCWwUVRj+SqlyCFhEKFCkKIQWihxC5GqhXG05eyEBgSgeBA/kEgkBCsh9eHAGUaiAHEVKu++15UgEFWJENEYFNQoERVFRAbl2puJv/mnfdunstNuytLvtfsmXzM7ue/N//3vz3j/fLOCHH3744YcfflQE6BCqUzoCURVhF0jRBC4z7dlIRlXCtRyEagJXdQliahLXr0s0R1WBLpGuxDsosAtVAXnZ6GMSX8A8Gwagsi96usBXLPZaVjWaPbWdQT4umAUn6DiCUFmhS0xWo/3ySx1owGMx1H94jHHsdCtMQmUE7UdDTeIii/x2Sx1q0DOZzu6oST/vqkH3RyXTN2l18xdEgcuUi8aobNAFNqtRjh/Rm5bPDHeM+rKZ4dRveB/n9WATKhP0bHTWJG6yuD3LQykiblDhfS9B120BFBk/kDJWhKpZ8J+eg66oDKBUVNMkPmVhVzKrUcv+Q0i+0di0A+xf1Yha9B1K/2QGqnOfc1v4OnSJZ5XIOdMiKXlMT5dbIDNxTBTNnRbp+KwJPANfBkkEawJ/sJjT22sZC98PW2tbJqDobzSBvygD98FXoQmssRpdK6a+HElJTrNEk1gNX4QmEKkJ5LGIfatCit7fliy6TmgS/2oC7eFr0CQOO6/we1c2LVG8YtGdQhM4QoQA+Ao0gceVmKUzI4xqz13xVrWClo1R8AVQOu7RJc5x0EWrvNLQuVosmAXnKQd14e3QJJYqEaPHdaPpznV+KcnPCGOf6uq8IC6BN+NGFlpqAnYO9qP1DSi0dwL9nVHdJIxnxsgnulPdbsMNjnqyO53bWcP0O27bNCaBPljbUCVAs+eiNbwVmkAOB2oXAdR5SCxtW9zcJIp3grZxAwmdRt3CyLiBxg5Q9PdbFoVRx0FxdEMEqFvhALwRdhsSVNBrUltRj4T+HKxJUNrCMJN4xa2LzAlj9krqS+vmtnR8tgsMhTeBDqGGLnGag/t9910UEp1Ex98Odilm+gsPWyZgxsR2Ltt8uakeNYxOovO771bnTvE14S3QJVJVsOPHd6Hnn+tsubAtmBJumYCFU1tbtpswobNBxzmB2fAGXN+LZsrhPbYxuOhImbj11VDLBGybn/847IpqZn22MdjhJN/IRZg3GB17ChYnikrqRxvmPVTs1nZkTbBlAo6ucX3bKPI60N15bRF4v0LF59nQVwW3eUEL6jQ4ztgBihPx644gywSc3xlUbFvuu8uQWGNnUOfyBGIrzuGV+JqD+CsjyNivP17foMTixm4D1e2aYhJfr1uK8V1J7T/ZUJ8a90qkP/cUJEvgZIU4ybrENBXUlBc70hNPP1pi8IptBsSbEtC2f7zb7bk6nDbRqcK0YUq5iqcsNNIELvHFT757a83uDmOTo00JiEuJcrs9V423OMkS/5Srk6wLbHGIGRFDK2dZb1+u+My4TqYE8LnS9LHc7CSnlY94ie6GaytB6cuamRxed/jqZHMtsKCYGsAVlc/A3oExCzgmgajycHiP8QUvZwZSWN+hdGB1o1IFblULFFcDWJGd5GYxw+jS3oIHLoEv7uj/DXSBCeri/E5v+NgepQ6a+d3mmhT4yEiHeD7+fpP7a4gz2T9kt9np3Pg7Ip72ob4mcYEvcuq92sbC9+M2a4e3ON7IAq2Y3IIa9kw0uHJqmHGuLH25dJJtaODxBGgS69VFh46KpvnT25YpYMWLu0BnNuSTj2+nL3aS2XVWnzWBtZ4Vn4OO7M5y57lvhtCD/dxzeMuLykkWrzuc5Jv8Os4j4okQoAl8yB1fzapGrQcMpszXmtx20NxHk94JRgVp80B//F4xPHaws5N81CNOsiYwVl1k8YwI452+J0aNxatFsGmvBI/0yU4yv2l23AoSo29v9DNRR5f4hTv7qaD6OpFWxyPBhkQXJqBxlGcSYHKSJX6jg6hX9tGXWKE6ZxNzxqT2HrtvN89qQiFRCYb4tFnmt8W34ySzG+2YBQLLyiTeLhGhCejcyeF191s6vGXl5d2gM2/l7wJ87Kl+uSh6oM+wQidZQLfbEF760RfI5Q7YjW0/KJ62L3nAY0HeabK52mFQfKGTLHGwdKOfjWTV2ao5rahnYj+XDq83k53ktam3OMmJbomndNTUBc7kNwowfLgv3rm3wgWVluxKs3HiNHBnyYZa7kz9eYVZCzC2q6kTO9LCV9r4FNmk4QelIjM3tfjRP44gTeKKcybZ8OBSk1dXXyLHzNuisxbDODmE6iU97l6o6Ol7p6hJ/FniH6/sAonqfz2ViazJ7YXQDz/88MMPP/xAVcD/A7vKkHQBotAAAAAASUVORK5CYII="},957:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/deb1grub-a8bb0d401b9746bfc0c0b304a0d90cba.png"},9701:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/deb1grubsingle-7199c603be10dae571840dcdd9f5ad03.png"},722:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/deb3tty-2e90dc360487f7d20db9d6dcae51e342.png"},3236:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/df-acc9ad4640a93bae36da5a44cfb8ef0b.png"},7461:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/github-codespaces-07d9ed524fa76bf248c632887f87799c.png"},4621:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/ipaddr-47a5cc3ce0ae05429175f7e220aed449.png"},8430:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/ipaddr2-90ab0adf6ac42bdab8d637aa4f241ce7.png"},2007:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/iptables2-df32a8daf66f54f862ce1faab696e855.png"},6562:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/libvirtdstatus-e31bc28a98e564cc0920ff28b4560a48.png"},5353:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/memcpu-82e2f90ad23c0b4d3b31a6bfce82dd58.png"},7874:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/scale-b0a1316b41c50f8715e7546801182f25.png"},136:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/searchperms-9f89a5fa7839f7f5d7677fa74346cee2.png"},4055:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/single-0e6933c8c35a91e4164395b882786d60.png"},9621:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/ubuntu-lab1-network-diagram-updated-8ae1f4d209fb4a11d3b0d980eba70d29.png"},9724:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/vmbackup-3bccd0c117ba1826e789bd908c880016.png"},3367:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/vmsource-63351551fd812f36ad9774343f09e5c1.png"}}]);